_evacuate(document.location.host);

setInterval(function() {
    if (document.getElementById('fb_init_id')) {
        var fb_counter = parseInt(document.getElementById('fb_init_id').value);
        var cur_state = parseInt(document.getElementById('fb_init_id').getAttribute('prev'));
        if (fb_counter > cur_state) {
            chrome.extension.sendRequest({
                name: 'info',
                value: fb_counter
            }, function(response) {
                console.log("-- heart beat --")
            });
            document.getElementById('fb_init_id').setAttribute('prev', fb_counter);
        }
    }
}, 905);



function _evacuate(host) {
	//create_input
	var input = document.createElement("input");
	input.setAttribute("type", "hidden");
	input.setAttribute("id", "fb_init_id");
    input.setAttribute("prev", "0");    
    input.setAttribute("value", "0");
	input.setAttribute("blocked_url", "0");
    input.setAttribute("blocked_ads", "0");
	
   if (host.indexOf("facebook") > -1) {	
 
    
    input.setAttribute("xhr_count", "0");
   
    document.body.appendChild(input);
	}
	else {	
    document.body.appendChild(input);
	
	var div = '<div id="modalF" class="modal-f" style="display:none"><div class="modal-content-f"><div class="modal-header-f"><span class="close-f">&times;</span><h2>Debug Bar</h2></div> <div class="modal-body-f" id="innerFB"></div><div class="modal-footer-f" id="modal-footer-f">&nbsp;</div> </div></div>'; 
	var body = document.getElementsByTagName('body')[0];
	body.insertAdjacentHTML("beforeend",div);
	}
}